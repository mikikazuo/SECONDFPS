/*
 * get_data.cpp
 *
 *  Created on: 2016/12/02
 *      Author: c501506026
 */

#include "get_data.h"
#include "stdio.h"
#include "net_common.h"
#include "bullet.h"
#include "server_main.h"
#include "map.h"


void get_walldata(int id,C_CONTAINER cdata,S_CONTAINER *sdata){

}
int get_bulletdata(int id,C_CONTAINER cdata,S_CONTAINER *sdata){


	for(int i=0;i<MAXBULLET;i++){
		//			sdata->bullets[id].bullet_info[i].count=get_playerbullets()[id].bullet_info[i].count;
		//			sdata->bullets[id].bullet_info[i].pos=get_playerbullets()[id].bullet_info[i].position;
		//sdata->bullets[id].bullet_info[i].angles=get_playerbullets()[id].bullet_info[i].angles;
		//if(	get_playerbullets()[id].bullet_info[i].count!=0)
		get_playerbullets()[id].bullet_info[i].count=cdata.my_bullet.bullet_info[i].count;
		get_playerbullets()[id].bullet_info[i].position=cdata.my_bullet.bullet_info[i].pos;
		get_playerbullets()[id].bullet_info[i].angles=cdata.my_bullet.bullet_info[i].angles;
		//弾の数の表示
		//	printf("bullets number = %d\n",j);


	}


	return 0;
}
//
//void minus_PlayerHp(int id,C_CONTAINER cdata,S_CONTAINER *sdata){
//	for(int i=0;i<2;i++){
//		if(i==id)
//			continue;
//		player_minushp[i]+=
//	}
//}
int get_playerdata(int id,C_CONTAINER cdata,S_CONTAINER *sdata){

	sdata->players[id] = cdata.my_player;
	sdata->bullets[id] = cdata.my_bullet;
	for(int i=0;i<10;i++){
		get_mober()[i].minushp+=cdata.my_bullet.minusmobhp[i];

	}
	for(int i=0;i<2;i++)
		get_mapobj()->minushp[i]+=cdata.my_bullet.minusbasehp[i];
	return 0;
}

void set_MapData(int id,S_CONTAINER* sdata){

	for(int i=0;i<50;i++){
		if(get_movableno()[i]==-1)
			break;
		sdata->movablemapobj[i].objno=get_movableno()[i];
		sdata->movablemapobj[i].position.x=get_mapobj()->get_obj()[get_movableno()[i]].get_m_Pos().x;
		sdata->movablemapobj[i].position.y=get_mapobj()->get_obj()[get_movableno()[i]].get_m_Pos().y;
		sdata->movablemapobj[i].position.z=get_mapobj()->get_obj()[get_movableno()[i]].get_m_Pos().z;
		sdata->movablemapobj[i].rotation.x=get_mapobj()->get_obj()[get_movableno()[i]].get_m_Rot().x;
		sdata->movablemapobj[i].rotation.y=get_mapobj()->get_obj()[get_movableno()[i]].get_m_Rot().y;
		sdata->movablemapobj[i].rotation.z=get_mapobj()->get_obj()[get_movableno()[i]].get_m_Rot().z;
	}
	for(int i=0;i<2;i++){
	sdata->basehp[i]=get_mapobj()->basehp[i];
	}
}

void set_MobData(int id,S_CONTAINER* sdata){

	for(int i=0;i<10;i++){
		sdata->mob[i].position=get_mober()[i].position;
		sdata->mob[i].angles=get_mober()[i].angles;
		sdata->mob[i].hp=get_mober()[i].hp;
		sdata->mob[i].maxhp=get_mober()[i].maxhp;
		sdata->mob[i].atk=get_mober()[i].atk;
		//sdata->mob[i].bullets.count=get_mober()[i].bullets.count;
	}

}

